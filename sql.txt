##Turnout rate (%) by district.


SELECT
  district,
  ROUND(100.0 * SUM(CASE WHEN has_voted THEN 1 ELSE 0 END) / COUNT(*), 2)
    AS turnout_pct
FROM voters
GROUP BY district;


#Top 3 polling stations by total votes cast.


SELECT polling_station, COUNT(*) AS votes_cast
FROM voters
WHERE has_voted = TRUE
GROUP BY polling_station
ORDER BY votes_cast DESC
LIMIT 3;

#How many voters by education level and party affiliation?

SELECT education_level,
       party_affiliation,
       COUNT(*) AS num_voters
FROM voters
GROUP BY education_level, party_affiliation
ORDER BY education_level, num_voters DESC;

##Question: What is the voter turnout rate for each hour of the day?


SELECT
  EXTRACT(HOUR FROM voting_time) AS hour_of_day,
  ROUND(100.0 * SUM(CASE WHEN has_voted THEN 1 ELSE 0 END) / COUNT(*), 2) AS turnout_pct
FROM voters
GROUP BY hour_of_day
ORDER BY hour_of_day;

##For each candidate, how many votes did they get from each income category?
SELECT 
    candidate_id,
    candidate_name,
    income_category,
    COUNT(*) AS vote_count
FROM votes
GROUP BY candidate_id, candidate_name, income_category
ORDER BY candidate_id, vote_count DESC;
 Grouped Bar Chart (Recommended)